<!DOCTYPE html>
<html lang="en">

<head>
    <title> Member Dashboard </title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description"
        content="Gradient Able Bootstrap admin template made using Bootstrap 4. The starter version of Gradient Able is completely free for personal project." />
    <meta name="keywords"
        content="free dashboard template, free admin, free bootstrap template, bootstrap admin template, admin theme, admin dashboard, dashboard template, admin template, responsive" />
    <meta name="author" content="codedthemes">
    <!-- Favicon icon -->
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <!-- Google font-->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet">
    <!-- Required Fremwork -->
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap/css/bootstrap.min.css">
    <!-- themify-icons line icon -->
    <link rel="stylesheet" type="text/css" href="/assets/icon/themify-icons/themify-icons.css">
    <link rel="stylesheet" type="text/css" href="/assets/icon/font-awesome/css/font-awesome.min.css">
    <script src="https://kit.fontawesome.com/5ab9576851.js" crossorigin="anonymous"></script>
    <!-- Bootstrap icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

    <!-- ico font -->
    <link rel="stylesheet" type="text/css" href="/assets/icon/icofont/css/icofont.css">
    <!-- Style.css -->
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/jquery.mCustomScrollbar.css">
    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <style>
        .danger {
            border: 1px solid #ccc;
            background-color: rgb(235, 92, 92);
            padding: 5px 8px;
            color: antiquewhite;
            width: 80px;
        }

        .report-success {
            border: 1px solid #ccc;
            background-color: rgb(56, 202, 112);
            padding: 5px 8px;
            color: black;
            width: 80px;
        }
    </style>

</head>

<body>

    <body>
        <!-- Pre-loader start -->
        <div class="theme-loader">
            <div class="loader-track">
                <div class="loader-bar"></div>
            </div>
        </div>
        <!-- Pre-loader end -->
        <div id="pcoded" class="pcoded">
            <div class="pcoded-overlay-box"></div>
            <div class="pcoded-container navbar-wrapper">

                <nav class="navbar header-navbar pcoded-header">
                    <div class="navbar-wrapper">
                        <div class="navbar-logo">
                            <a class="mobile-menu" id="mobile-collapse" href="#!">
                                <i class="ti-menu"></i>
                            </a>
                            <div class="mobile-search">
                                <div class="header-search">
                                    <div class="main-search morphsearch-search">
                                        <div class="input-group">
                                            <span class="input-group-addon search-close"><i class="ti-close"></i></span>
                                            <input type="text" class="form-control" placeholder="Enter Keyword">
                                            <span class="input-group-addon search-btn"><i class="ti-search"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <a href="/member/dashboard">
                                <p>Welcome <%= member.name %>
                                </p>
                            </a>
                            <a class="mobile-options">
                                <i class="ti-more"></i>
                            </a>
                        </div>

                        <div class="navbar-container container-fluid">
                            <ul class="nav-right">
                                <li class="user-profile header-notification">
                                    <a href="#">
                                        <img src="/assets/images/avatar-4.jpg" class="img-radius"
                                            alt="User-Profile-Image">
                                        <span>
                                            <%= member.name %>
                                        </span>
                                        <i class="ti-angle-down"></i>
                                    </a>
                                    <ul class="show-notification profile-notification">

                                        <li>
                                            <a href="#" data-toggle="modal" data-target="#memberProfileModal"> Profile
                                            </a>
                                        </li>
                                        <li>
                                            <a href="/member/logout"> Logout </a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>
                <div class="pcoded-main-container">
                    <div class="pcoded-wrapper">
                        <nav class="pcoded-navbar">
                            <div class="sidebar_toggle"><a href="#"><i class="icon-close icons"></i></a></div>
                            <div class="pcoded-inner-navbar main-menu">

                                <div class="pcoded-navigatio-lavel" data-i18n="nav.category.navigation">Dashboard</div>
                                <ul class="pcoded-item pcoded-left-item">
                                    <li class="active">
                                        <a href="/member/dashboard">
                                            <span class="pcoded-micon"><i class="ti-home"></i><b>D</b></span>
                                            <span class="pcoded-mtext" data-i18n="nav.dash.main">Dashboard</span>
                                            <span class="pcoded-mcaret"></span>
                                        </a>
                                    </li>
                                </ul>

                                <div class="pcoded-navigatio-lavel" data-i18n="nav.category.forms">Chart</div>
                                <ul class="pcoded-item pcoded-left-item">
                                    <li>
                                        <a href="#">
                                            <span class="pcoded-micon"><i class="ti-layers"></i><b>FC</b></span>
                                            <span class="pcoded-mtext" data-i18n="nav.form-components.main">Chart</span>
                                            <span class="pcoded-mcaret"></span>
                                        </a>
                                    </li>
                                </ul>

                                <div class="pcoded-navigatio-lavel" data-i18n="nav.category.forms">Trainer</div>
                                <ul class="pcoded-item pcoded-left-item">
                                    <li>
                                        <a href="#" data-toggle="modal" data-target="#trainerModal">
                                            <span class="pcoded-micon"><i
                                                    class="bi bi-person-badge"></i><b>FC</b></span>
                                            <span class="pcoded-mtext" data-i18n="nav.form-components.main">Your
                                                Trainer</span>
                                            <span class="pcoded-mcaret"></span>
                                        </a>
                                    </li>
                                </ul>

                                <div class="pcoded-navigatio-lavel" data-i18n="nav.category.forms">Profile</div>
                                <ul class="pcoded-item pcoded-left-item">
                                    <li>
                                        <a href="#" data-toggle="modal" data-target="#memberProfileModal">
                                            <span class="pcoded-micon"><i class="bi bi-person"></i><b>FC</b></span>
                                            <span class="pcoded-mtext"
                                                data-i18n="nav.form-components.main">Profile</span>
                                            <span class="pcoded-mcaret"></span>
                                        </a>
                                    </li>
                                </ul>
                                <div class="pcoded-navigatio-lavel" data-i18n="nav.category.forms">Membership Plan</div>
                                <ul class="pcoded-item pcoded-left-item">
                                    <li>
                                        <a href="#" data-toggle="modal" data-target="#membershipModal">
                                            <span class="pcoded-micon"><i class="bi bi-person"></i><b>FC</b></span>
                                            <span class="pcoded-mtext" data-i18n="nav.form-components.main">View
                                                Status</span>
                                            <span class="pcoded-mcaret"></span>
                                        </a>
                                    </li>
                                </ul>

                            </div>
                        </nav>
                        <div class="pcoded-content">
                            <div class="pcoded-inner-content">
                                <div class="main-body">
                                    <div class="page-wrapper">

                                        <div class="page-body">
                                            <div class="row">

                                                <!-- statistic and process start -->
                                                <!-- <div class="col-lg-8 col-md-12">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <h5>Statistics</h5>
                                                            <div class="card-header-right">
                                                                <ul class="list-unstyled card-option">
                                                                    <li><i class="fa fa-chevron-left"></i></li>
                                                                    <li><i class="fa fa-window-maximize full-card"></i>
                                                                    </li>
                                                                    <li><i class="fa fa-minus minimize-card"></i></li>
                                                                    <li><i class="fa fa-refresh reload-card"></i></li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                        <div class="card-block">
                                                            <canvas id="Statistics-chart" height="200"></canvas>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4 col-md-12">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <h5>Today's Goal</h5>
                                                        </div>
                                                        <div class="card-block">
                                                            <span
                                                                class="d-block text-c-blue f-24 f-w-600 text-center">265687</span>
                                                            <canvas id="feedback-chart" height="100"></canvas>
                                                            <div class="row justify-content-center m-t-15">
                                                                <div class="col-auto b-r-default m-t-5 m-b-5">
                                                                    <h4>83%</h4>
                                                                    <p class="text-success m-b-0"><i
                                                                            class="ti-hand-point-up m-r-5"></i>Achived
                                                                    </p>
                                                                </div>
                                                                <div class="col-auto m-t-5 m-b-5">
                                                                    <h4>17%</h4>
                                                                    <p class="text-danger m-b-0"><i
                                                                            class="ti-hand-point-down m-r-5"></i>Not
                                                                        Achived</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div> -->
                                                <!-- statustic and process end -->

                                                <!-- tabs card start -->
                                                <div class="col-sm-12">
                                                    <div class="card tabs-card">
                                                        <div class="card-block p-0">
                                                            <!-- Nav tabs -->
                                                            <ul class="nav nav-tabs md-tabs" role="tablist">
                                                                <li class="nav-item">
                                                                    <a class="nav-link" data-toggle="tab"
                                                                        href="#messages3" role="tab"><i
                                                                            class="fas fa-dumbbell"></i>All
                                                                        Equipments</a>
                                                                    <div class="slide"></div>
                                                                </li>
                                                            </ul>
                                                            <!-- Tab panes -->
                                                            <div class="tab-content card-block">
                                                                <div class="tab-pane active" id="home3" role="tabpanel">


                                                                    <div class="tab-pane" id="messages3"
                                                                        role="tabpanel">

                                                                        <div class="table-responsive">
                                                                            <table class="table">
                                                                                <tr>
                                                                                    <th>Equipment</th>
                                                                                    <th>Equipment Name</th>
                                                                                    <th>Equipment Quantity</th>
                                                                                    <th>Equipment Reports</th>
                                                                                    <th>Report</th>

                                                                                </tr>
                                                                                <% for(var i=0;i <
                                                                                    equipments.length;i++){ %>
                                                                                    <tr>
                                                                                        <td><img src="/assets/images/product/prod1.jpg"
                                                                                                alt="prod img"
                                                                                                class="img-fluid"></td>
                                                                                        <td>
                                                                                            <%=equipments[i].name%>
                                                                                        </td>
                                                                                        <td>
                                                                                            <%=equipments[i].total_cnt%>
                                                                                        </td>
                                                                                        <td><span
                                                                                                id="<%=equipments[i]._id%>"
                                                                                                class="label label-primary">
                                                                                                <%=equipments[i].reports%>
                                                                                            </span>
                                                                                        </td>
                                                                                        <td>
                                                                                            <button
                                                                                                id="<%=equipments[i]._id%>-<%=equipments[i].reports%>"
                                                                                                onclick="reportBtnChange(this.id)"
                                                                                                class="danger">Report</button>
                                                                                        </td>

                                                                                    </tr>
                                                                                    <% } %>

                                                                            </table>
                                                                        </div>
                                                                        <div class="text-center">
                                                                            <button
                                                                                class="btn btn-outline-primary btn-round btn-sm">Load
                                                                                More</button>
                                                                        </div>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- tabs card end -->

                                            </div>
                                        </div>

                                        <div id="styleSelector">

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trainer Profile modal -->

            <div class="modal fade" id="trainerModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <h4 class="modal-title w-100 font-weight-bold">Your Trainer Details <i
                                    class="fas fa-user-tie"></i></h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body mx-3">
                            <div class="md-form mb-2">
                                <label for="tname">Trainer Name</label>
                                <input type="text" id="tname" name="name" value="<%=trainerDetails.name%>"
                                    class="form-control" placeholder="" aria-label="tdate"
                                    aria-describedby="basic-addon1" readonly>
                            </div>

                            <div class="md-form mb-2">
                                <label for="tdate">Trainer Joining Date </label>
                                <input type="text" id="tdate" name="tdate" value="<%=trainerDetails.registration_date%>"
                                    class="form-control" placeholder="" aria-label="tdate"
                                    aria-describedby="basic-addon1" readonly>

                            </div>

                            <div class="md-form mb-2">
                                <label for="tcontact">Trainer Contact Number </label>
                                <input type="text" id="tcontact" name="tcontact" value="<%=trainerDetails.contact_no%>"
                                    class="form-control" placeholder="" aria-label="tcontact"
                                    aria-describedby="basic-addon1" readonly>

                            </div>

                        </div>
                        <div class="modal-footer d-flex justify-content-center">
                            <button type="submit" class="btn btn-outline-danger">Report</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trainer Profile Modal ends -->

            <!-- Member Profile Modal -->
            <div class="modal fade" id="memberProfileModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <h4 class="modal-title w-100 font-weight-bold">Your Profile <i
                                    class="bi bi-person-circle"></i></h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body mx-3">
                            <div class="md-form mb-2">
                                <label for="name"> Name</label>
                                <input type="text" id="name" name="name" value="<%=member.name%>" class="form-control"
                                    placeholder="" aria-label="name" aria-describedby="basic-addon1" readonly>
                            </div>

                            <div class="md-form mb-2">
                                <label for="city">City </label>
                                <input type="text" id="city" name="city" value="<%=member.city%>" class="form-control"
                                    placeholder="" aria-label="city" aria-describedby="basic-addon1" readonly>

                            </div>

                            <div class="md-form mb-2">
                                <label for="contact">Contact No</label>
                                <input type="text" id="contact" name="contact" value="<%=member.contact_no%>"
                                    class="form-control" placeholder="" aria-label="contact"
                                    aria-describedby="basic-addon1" readonly>

                            </div>

                            <div class="md-form mb-2">
                                <label for="email">Email</label>
                                <input type="email" id="email" name="email" value="<%=member.email%>"
                                    class="form-control" placeholder="" aria-label="email"
                                    aria-describedby="basic-addon1" readonly>

                            </div>


                        </div>
                        <div class="modal-footer d-flex justify-content-center">
                            <button type="button" class="btn btn-outline-danger">Update</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Member Profile Modal ends -->

            <!-- Membeship Modal -->

            <!-- Modal -->
            <div class="modal fade" id="membershipModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog ">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Membership Status 
                                <% var today  = new Date() %>
                                <% var expiry = member.membership %>
                                <% expiry.setMonth(expiry.getMonth() + 3) %>
                                <% if(today > expiry) { %>
                                <span class="membershipExpired">Expired</span>
                                <% } else { %>
                                <span class="membershipSuccess">Active</span>   
                                <% } %>
                             </h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">&times;</button> -->
                        </div>
                        <div class="modal-body">
                            <div  id="countdown" class="countdown">
                                <div class="time days">
                                    <span id="days">0</span>
                                    Days
                                </div>
                                <div  class="time hours">
                                    <span id="hours">0</span>
                                    Hours
                                </div>
                                <div class="time minutes">
                                    <span id="minutes">0</span>
                                    Minutes
                                </div>
                                <div  class="time seconds">
                                    <span id="seconds">0</span>
                                    Seconds
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <!-- <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button> -->
                            <% if(today > expiry) { %>
                                <!-- <form action="/member/dashboard/renew" method="POST"> -->
                                    <button id="btn" type="submit" class="btn btn-primary">Renew</button>
                                <!-- </form> -->
                                <% } else { %>
                                <button type="button" disabled class="btn btn-primary">Renew</button> 
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>
            <!---->

            <!-- Required Jquery -->
            <script type="text/javascript" src="/assets/js/jquery/jquery.min.js"></script>
            <script type="text/javascript" src="/assets/js/jquery-ui/jquery-ui.min.js"></script>
            <script type="text/javascript" src="/assets/js/popper.js/popper.min.js"></script>
            <script type="text/javascript" src="/assets/js/bootstrap/js/bootstrap.min.js"></script>
            <!-- jquery slimscroll js -->
            <script type="text/javascript" src="/assets/js/jquery-slimscroll/jquery.slimscroll.js"></script>
            <!-- modernizr js -->
            <script type="text/javascript" src="/assets/js/modernizr/modernizr.js"></script>
            <!-- am chart -->
            <script src="/assets/pages/widget/amchart/amcharts.min.js"></script>
            <script src="/assets/pages/widget/amchart/serial.min.js"></script>
            <!-- Chart js -->
            <script type="text/javascript" src="/assets/js/chart.js/Chart.js"></script>
            <!-- Todo js -->
            <script type="text/javascript " src="/assets/pages/todo/todo.js "></script>
            <!-- Custom js -->
            <script type="text/javascript" src="/assets/pages/dashboard/custom-dashboard.min.js"></script>
            <script type="text/javascript" src="/assets/js/script.js"></script>
            <script type="text/javascript " src="/assets/js/SmoothScroll.js"></script>
            <script src="/assets/js/pcoded.min.js"></script>
            <script src="/assets/js/vartical-demo.js"></script>
            <script src="/assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
            <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
            <script src="/js/payment.js"></script>
    </body>
    <!-- Countdown Timer -->
    <script>
        var expiryCountdown = new Date("<%=member.membership%>");
        //expiryCountdown.setMonth(expiryCountdown.getMonth() + 3) 
        var countDownDate = new Date(expiryCountdown).getTime();
        //console.log(expiryCountdown);
        // Update the count down every 1 second
          var x = setInterval(function() {
        
          var now = new Date().getTime();
        
          // Find the distance between now and the count down date
          var distance = countDownDate - now;
        
          // Time calculations for days, hours, minutes and seconds
          var days = Math.floor(distance / (1000 * 60 * 60 * 24));
          var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
          var seconds = Math.floor((distance % (1000 * 60)) / 1000);
        
          document.getElementById("days").innerHTML = days;
          document.getElementById("hours").innerHTML = hours;
          document.getElementById("minutes").innerHTML = minutes;
          document.getElementById("seconds").innerHTML = seconds;
        
          // If the count down is finished
          if (distance < 0) {
            clearInterval(x);
            document.getElementById("countdown").innerHTML = "Expired";
          
          }
        }, 1000);
     </script>

     <!-- Report Increment -->
    <script>
        function reportBtnChange(id) {
            $(`#${id}`).html("Reported");
            $(`#${id}`).removeClass("danger");
            $(`#${id}`).addClass("report-success");
            $(`#${id}`).attr("disabled", true);
            let s = id.split("-");
            let equipment_id = s[0];
            let reportCnt = parseInt(s[1]) + 1;
            $(`#${equipment_id}`).html(reportCnt);
            let reported_by = "<%=member.name%>";
            let user_id = "<%=member._id%>";
            let object = {
                method: "POST",                        // declares HTTP request method
                headers: {
                    "Content-Type": "application/json",  // declares format of data
                    "Accept": "application/json"

                },
                body: JSON.stringify(
                    {
                        "report": reportCnt,
                        "reported_by": reported_by,
                        "user_id": user_id,
                        "equipment_id": equipment_id

                    }
                )

            };

            fetch("http://localhost:3000/updateReportCnt", object);
        }
    </script>

</html>